<!doctype html>
<html>
  <head>
    <title>{{ page_title }}</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="description" content="{{ page_description | escape }}">
    <link rel="canonical" href="{{ canonical_url }}">
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
    {{ content_for_header }}
    <!-- Header hook for plugins -->
    <link rel="preload" href="{{ 'tan-pearl.otf' | asset_url }}" as="font" type="font/otf" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;700&display=swap">
    
    <link href="{{ 'application.css' | asset_url }}" rel="stylesheet">
    <script src="{{ 'application.js' | asset_url }}" defer></script>

    <!-- Font Face Declaration -->
    <style>
      @font-face {
        font-family: 'Tan Pearl';
        src: url('{{ "tan-pearl.otf" | asset_url }}') format('opentype');
        font-weight: normal;
        font-style: normal;
        font-display: swap;
      }

      /* Ensure fonts are applied when loaded */
      .fonts-loaded .hero_section__title,
      .fonts-loaded .header-logo,
      .fonts-loaded .footer-brand-title {
        font-family: '{{ settings.theme_font }}', serif !important;
      }
      
     
    </style>
  </head>
  <body class="fonts-loading">
    <!-- Loading Screen -->
    {% section 'loading-screen' %}


    {% render 'header' %}
    <main role="main">
      {{ content_for_layout }}
    </main>
    {% render 'footer' %}

    <script>
      // Simplified font loading
      if ('fonts' in document) {
    Promise.all([
      document.fonts.load('1em Tan Pearl'),
      document.fonts.load('1em Cormorant Garamond')
    ]).then(() => {
      document.documentElement.classList.add('fonts-loaded');
      document.documentElement.classList.remove('fonts-loading');
    }).catch(() => {
      // Fallback if any font fails to load
      document.documentElement.classList.add('fonts-loaded');
      document.documentElement.classList.remove('fonts-loading');
    });
  } else {
    // Fallback for browsers without Font Loading API
    setTimeout(() => {
      document.documentElement.classList.add('fonts-loaded');
      document.documentElement.classList.remove('fonts-loading');
    }, 1000);
  }

      

      // Header scroll effect
      let ticking = false;
      let lastScrollTop = 0;

      function updateHeader() {
        const header = document.querySelector('.site-header');
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;

        if (scrollTop > 50 && lastScrollTop <= 50) {
          header.classList.add('scrolled');
        } else if (scrollTop <= 50 && lastScrollTop > 50) {
          header.classList.remove('scrolled');
        }

        lastScrollTop = scrollTop;
        ticking = false;
      }

      function requestTick() {
        if (!ticking) {
          requestAnimationFrame(updateHeader);
          ticking = true;
        }
      }

      window.addEventListener('scroll', requestTick, { passive: true });
    </script>

  </body>
</html>