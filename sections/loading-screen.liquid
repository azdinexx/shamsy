{% comment %}
  Loading Screen - Hardcoded animation from center to top with fade
{% endcomment %}

{% if section.settings.enable_loading_screen %}
  <div id="loading-screen-{{ section.id }}" class="loading-screen">
    <div class="loading-content">
      {% if section.settings.loading_logo != blank %}
        <div class="loading-logo">
          <img 
            src="{{ section.settings.loading_logo | image_url: width: 400 }}" 
            alt="{{ section.settings.loading_logo_alt | default: shop.name | escape }}"
            class="loading-logo-image"
            width="200"
            height="200"
            loading="eager"
            decoding="sync">
        </div>
      {% endif %}
    </div>
  </div>

  <style>
    .loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: #f3e9dc;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      opacity: 1;
      transition: opacity 0.5s ease;
      pointer-events: none;
      overflow: hidden;
    }

    .loading-content {
      width: 100%;
      height: 100%;
      position: relative;
      text-align: center;
    }

    .loading-logo {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(1);
      opacity: 1;
      will-change: transform, opacity;
    }

    .loading-logo.animate-to-header {
      animation: logoToTop 1.5s ease-in-out forwards;
    }

    @keyframes logoToTop {
      0% {
        top: 50%;
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
      }
      100% {
        top: 50px;
        transform: translate(-50%, -50%) scale(0.3);
        opacity: 0;
      }
    }

    .loading-logo-image {
      width: 200px;
      height: auto;
    }

    @media (prefers-reduced-motion: reduce) {
      .loading-screen,
      .loading-logo,
      .loading-logo-image {
        transition: none;
        animation: none;
      }
    }
  </style>

  <script>
    window.addEventListener('load', () => {
      const loadingScreen = document.getElementById('loading-screen-{{ section.id }}');
      const loadingLogo = document.querySelector('.loading-logo');
      const headerLogo = document.querySelector('.header-logo .logo-image');

      document.body.style.overflow = 'hidden';

      if (loadingScreen && loadingLogo) {
        if (headerLogo) headerLogo.style.opacity = '0';

        setTimeout(() => {
          loadingLogo.classList.add('animate-to-header');
        }, 1000);

        loadingLogo.addEventListener('animationend', () => {
          loadingScreen.style.opacity = '0';
          if (headerLogo) headerLogo.style.opacity = '1';
          setTimeout(() => {
            loadingScreen.style.display = 'none';
          }, 500); // fade-out transition duration
        });
      }
    });
  </script>
{% endif %}

{% schema %}
{
  "name": "Loading Screen",
  "settings": [
    {
      "type": "checkbox",
      "id": "enable_loading_screen",
      "label": "Enable Loading Screen",
      "default": true
    },
    {
      "type": "image_picker",
      "id": "loading_logo",
      "label": "Loading Logo"
    },
    {
      "type": "text",
      "id": "loading_logo_alt",
      "label": "Logo Alt Text"
    }
  ],
  "presets": [
    {
      "name": "Loading Screen"
    }
  ]
}
{% endschema %}
